<html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><title>vue2.0一起在懵逼的海洋里越陷越深（五） - article - leenty blog Demo</title><link rel="shortcut icon" type="image/ico" href="/static/favicon.ico"><meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no,minimal-ui"><meta name="description" content="leenty | vue2.0 vue+vue-router+vuex Material-theme"><meta name="Keywords" content="leenty, vuejs, vue-router, vuex, 前端"><meta name="author" content="leenty"><meta property="og:type" content="website"><meta property="og:title" content="leenty | vue2.0-demo"><meta property="og:url" content="leenty | vue2.0 vue+vue-router+vuex Material-theme"><meta property="og:site_name" content="leenty | vue2.0-demo"><meta property="og:description" content="leenty | vue2.0 vue+vue-router+vuex Material-theme"><meta name="twitter:card" content="leenty"><meta name="twitter:title" content="leenty | vue2.0-demo"><meta name="twitter:description" content="leenty | vue2.0 vue+vue-router+vuex Material-theme"><meta name="renderer" content="webkit"><link rel="stylesheet" href="//cdn.bootcss.com/normalize/4.2.0/normalize.min.css"><link href="/static/css/app.897e2a501a3e40bec67043a943fc4118.css" rel="stylesheet"></head><body><div class="app u-clearfix"><div class="articleList l-page--Full"><div class="user u-borderBox"><div class="user__content fg-row fg-wrap--no fg-ai--c"><div class="user__avatar u-bgi--Center" style="background-image: url(https://avatars3.githubusercontent.com/u/13213680?v=3);"></div><div class="user__info l-pl5 u-va--m"><p class="user__name l-m--None">leenty</p><p class="user__options l-m--None"></p></div></div></div><ul class="articleList__content u-ul--Reset"><li class="articleList__li" style="transition: 0.2s; -webkit-transition: 0.2s;"><a href="/2016/10/21/vue2-1" class="articleList__link u-borderBox u-link__inherit l-flexV--c"><div class="articleList__title"><svg class="svg__home u-va--tb"><use xlink:href="#svg__articleIcon"></use></svg>vue2.0一起在懵逼的海洋里越陷越深（一） </div></a></li><li class="articleList__li" style="transition: 0.3s; -webkit-transition: 0.3s;"><a href="/2016/11/20/vue2-2" class="articleList__link u-borderBox u-link__inherit l-flexV--c"><div class="articleList__title"><svg class="svg__home u-va--tb"><use xlink:href="#svg__articleIcon"></use></svg>vue2.0一起在懵逼的海洋里越陷越深（二） </div></a></li><li class="articleList__li" style="transition: 0.4s; -webkit-transition: 0.4s;"><a href="/2016/11/27/vue2-3" class="articleList__link u-borderBox u-link__inherit l-flexV--c"><div class="articleList__title"><svg class="svg__home u-va--tb"><use xlink:href="#svg__articleIcon"></use></svg>vue2.0一起在懵逼的海洋里越陷越深（三） </div></a></li><li class="articleList__li" style="transition: 0.5s; -webkit-transition: 0.5s;"><a href="/2016/12/04/vue2-4" class="articleList__link u-borderBox u-link__inherit l-flexV--c"><div class="articleList__title"><svg class="svg__home u-va--tb"><use xlink:href="#svg__articleIcon"></use></svg>vue2.0一起在懵逼的海洋里越陷越深（四） </div></a></li><li class="articleList__li" style="transition: 0.6s; -webkit-transition: 0.6s;"><a href="/2016/12/11/vue2-5" class="articleList__link u-borderBox u-link__inherit l-flexV--c articleList__link--Active"><div class="articleList__title"><svg class="svg__home u-va--tb"><use xlink:href="#svg__articleIcon"></use></svg>vue2.0一起在懵逼的海洋里越陷越深（五） </div></a></li><li class="articleList__li" style="transition: 0.7s; -webkit-transition: 0.7s;"><a href="/2016/12/18/vue2-6" class="articleList__link u-borderBox u-link__inherit l-flexV--c"><div class="articleList__title"><svg class="svg__home u-va--tb"><use xlink:href="#svg__articleIcon"></use></svg>vue2.0一起在懵逼的海洋里越陷越深（六） </div></a></li></ul></div><div class="app__content l-page--Full"><header class="header u-clearfix"><div data-author="leenty's blog" class="header__content u-boxShadow" style="bottom: 0px;"><div class="mainButton"><div class="mainButton__body mainButton__menu"><button class="b-menu"></button></div></div><div class="header__menu l-flexH--sa"><a href="/" class="u-link__inherit header__link l-flexV--c"><svg class="svg__home"><use xlink:href="#svg__home"></use></svg><span>home </span></a><a href="/article" class="u-link__inherit header__link l-flexV--c"><svg class="svg__code"><use xlink:href="#svg__code"></use></svg><span>article</span></a><a href="/demo" class="u-link__inherit header__link l-flexV--c"><svg><use xlink:href="#svg__demo"></use></svg><span>demo</span></a></div></div></header><div class="app__bodyer l-mH--auto u-clearfix"><div class="article"><h1 class="u-ta--c">文章页面</h1><div class="md-content"><section><h3>前言</h3> <p>本文章系列：<a href="http://leenty.com/tags/vuejs/">vue2.0一起在懵逼的海洋里越陷越深 (http://leenty.com/tags/vuejs/)</a>
之前的几篇文章的说了<code>vue-router</code>以及<code>vuex</code>的简单使用，这次就开始组合这两者进行实际应用。
场地呢就在我的<a href="http://vue2.leenty.com">vue2.0Demo</a>,这是<a href="https://github.com/leenty/vue2">源码地址</a>,觉得靠谱的话欢迎加星跟随,有问题欢迎评论和指正😃
OK交代完毕，说下这回要完成的内容。
这回要做的是一个带缩放功能的滑动菜单(就是一个侧拉栏)和文章列表，以及文章的展示路由
使用<code>vuex</code>做状态管理控制<code>css</code>完成动画过度效果以及使用<code>vue-router</code>的嵌套路由功能。</p> <p><strong>滴滴滴！上车请刷卡</strong> <img src="http://leenty.com/img/vue/shangche.jpg" alt=""></p> <h3>正文</h3> <p>首先，我们先把核心功能完成，也就是<code>vue-router</code>的嵌套路由功能</p> <h4>嵌套路由功能</h4> <p>有些时候我们会遇到一个模板重复使用的情况，注意我说的并不是一个子模板在其父模板上的重复，而是多个页面之间的使用到相同的父模板。
就好比有这么几个路径</p> <ul><li><code>vue2.leenty.com/article/demo1</code></li> <li><code>vue2.leenty.com/article/demo2</code></li> <li><code>vue2.leenty.com/article/demo3</code>
可以发现其中共有的部分<code>vue2.leenty.com/article</code>。</li></ul> <pre><code>/article/demo1                 /article/demo2               /article/demo3
+------------------+           +-----------------+          +-----------------+
| article          |           | article         |          | article         |
| +--------------+ |           | +-------------+ |          | +-------------+ |
| | demo1        | |  +-----&gt;  | | demo2       | | +-----&gt;  | | demo3       | |
| |              | |           | |             | |          | |             | |
| +--------------+ |           | +-------------+ |          | +-------------+ |
+------------------+           +-----------------+          +-----------------+
</code></pre> <p>没错，这个路径指向的就是父模板，他在多个子路由里被重复的渲染，如果我们没有对其做嵌套路由的处理，结果将是不仅我们写的累，vuejs渲染的也多余，因为这个模板被反复的使用却每次都被重新渲染。
so，我们开始做嵌套路由吧！
打开路由列表文件(<code>routes.js</code>)
tips:不要把<code>routes.js</code>和项目里的<code>router.js</code>搞混咯，一个是路由列表文件<code>routes.js</code>，一个是路由导出文件<code>router.js</code>
在里面我们假定有一个基础的路由（这个文件在本系列第二章里有讲到）</p> <pre><code class="language-js"><span class="hljs-keyword">const</span> routes = [
  {
    <span class="hljs-attr">name</span>: <span class="hljs-string">'Article'</span>,
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/article'</span>,
    <span class="hljs-attr">component</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./components/Article.vue'</span>)
    <span class="hljs-comment">// 这里因为书写以及以后做异步组件的方便，将原先的import导入的方式改成了require的方式</span>
    <span class="hljs-comment">// 这么做不会实质上没和之前没有变化的，只是单纯的写法不同。</span>
  }
]

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> routes
</code></pre> <p>好，接下来我们加入子路由，
目前本系列已经有五篇文章，那么现在一一加入进去。
当前的项目路径</p> <pre><code>src
├── main.js               # vuejs应用入口
├── router.js             # 路由导出文件
├── routes.js             # 路由列表文件
├── App.vue               # vuejs应用根模板
├── components
│   ├── Home.vue
│   ├── Article.vue
│   ├── Demo.vue
│   ├── ...               # 存放各个路由入口文件
│   └── templates         # 存放模板
│       ├── AppArticleList.vue    # 文章列表 
│       └── ...
└── store
│   ├── index.js          # 组装模块并导出 store 的地方
│   ├── actions.js        # 根级别的 action
│   ├── mutations.js      # 根级别的 mutation
│   ├── types.js          # mutation命名空间
│   └── modules
│       ├── demo.js       # demo模块
│       └── status.js     # 全局应用状态模块
└── md                    # 存放md文件
    └── articles          # 文章路径 
        ├── vue2-1.vue
        ├── vue2-2.vue
        ├── vue2-3.vue
        ├── vue2-4.vue
        └── vue2-5.vue
        (这里为了讲解方便，会将.md文件替换为.vue文件，)
        (效果是一样的只是怕读者有些乱，.vue文件你们尝试的时候可以写些东西)
</code></pre> <p>嵌套路由时会在原有路由对象的基础上添加一个<code>children</code>的节点
代码如下：</p> <pre><code class="language-js"><span class="hljs-keyword">const</span> routes = [
  {
    <span class="hljs-attr">name</span>: <span class="hljs-string">'Article'</span>,
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/article'</span>,
    <span class="hljs-comment">// 父路由上尽量写绝对路径，不然可能会引起一些麻烦，</span>
    <span class="hljs-comment">// 有捣(xia)鼓(gao)精神的同学可以试试</span>
    component: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./components/Article.vue'</span>),
    <span class="hljs-attr">children</span>: [
    <span class="hljs-comment">// children节点：传入一个子路由数组，格式与父路由是一样的</span>
      {
        <span class="hljs-attr">name</span>: <span class="hljs-string">'vue2_1'</span>,
        <span class="hljs-attr">path</span>: <span class="hljs-string">'vue2_1'</span>,
        <span class="hljs-comment">// path: 导入的路径是相对路径，你不需要写全，如下的path将会被vuejs理解为：</span>
        <span class="hljs-comment">// '/article/vue2_1'</span>
        <span class="hljs-comment">// *** 注意： ***</span>
          <span class="hljs-comment">// 如果你写的是这样的相对路径，就千万别在前面加'/'，不然就意味着这是一个绝对路径</span>
        component: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./md/articles/vue2-1.vue'</span>)
      },
      {
        <span class="hljs-attr">name</span>: <span class="hljs-string">'vue2_2'</span>,
        <span class="hljs-attr">path</span>: <span class="hljs-string">'/article/vue2_2'</span>,
        <span class="hljs-comment">// 演示一个绝对路径，这样子的路径会被vuejs理解为其本意'/article/vue2_2'</span>
        <span class="hljs-comment">// 如果这里只写了'/vue2_2'的话，vuejs就会把路由理解为'/vue2_2'，</span>
        <span class="hljs-comment">// 不过不用担心他显示上的问题，只是url会有些有趣的区别</span>
        <span class="hljs-comment">// 你会发现虽然url变短了，但是父模板依然正常的显示着。</span>
        component: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./md/articles/vue2-2.vue'</span>)
      },
      {
        <span class="hljs-attr">name</span>: <span class="hljs-string">'vue2_3'</span>,
        <span class="hljs-attr">path</span>: <span class="hljs-string">'vue2_3'</span>,
        <span class="hljs-attr">component</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./md/articles/vue2-3.vue'</span>)
      },
      {
        <span class="hljs-attr">name</span>: <span class="hljs-string">'vue2_4'</span>,
        <span class="hljs-attr">path</span>: <span class="hljs-string">'vue2_4'</span>,
        <span class="hljs-attr">component</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./md/articles/vue2-4.vue'</span>)
      },
      {
        <span class="hljs-attr">name</span>: <span class="hljs-string">'vue2_5'</span>,
        <span class="hljs-attr">path</span>: <span class="hljs-string">'vue2_5'</span>,
        <span class="hljs-attr">component</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./md/articles/vue2-5.vue'</span>)
      }
    ]
  }
]

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> routes

</code></pre> <p>嗯，好了，这样嵌套路由就建立好了</p> <h4>对侧拉栏做状态管理</h4> <p>打开<code>src/store/modules/status.js</code>
代码如下</p> <pre><code class="language-js"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> types <span class="hljs-keyword">from</span> <span class="hljs-string">'../types'</span>
<span class="hljs-comment">// 引入命名空间，放置在types里</span>

<span class="hljs-keyword">import</span> getScrollData <span class="hljs-keyword">from</span> <span class="hljs-string">'../../utils/scroll'</span>
<span class="hljs-comment">// 这是获得滚动数据的js文件，具体怎样写的可以去我github开源项目里看</span>
<span class="hljs-comment">// 导出的是一个方法，这个方法返回一个对象</span>
<span class="hljs-comment">// {</span>
<span class="hljs-comment">//    scrollTop: 0,</span>
<span class="hljs-comment">//    scrollHeight: 0,</span>
<span class="hljs-comment">//    windowHeight: 0,</span>
<span class="hljs-comment">//    scrollBottom: 0</span>
<span class="hljs-comment">// }</span>

<span class="hljs-keyword">const</span> state = {
  <span class="hljs-attr">articleList</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-comment">// 布尔值，表示侧拉文章列表的开关</span>
  scroll: {
  <span class="hljs-comment">// 滚动相关的数据</span>
    scrollTop: <span class="hljs-number">0</span>,
    <span class="hljs-attr">scrollHeight</span>: <span class="hljs-number">0</span>,
    <span class="hljs-attr">windowHeight</span>: <span class="hljs-number">0</span>,
    <span class="hljs-attr">scrollBottom</span>: <span class="hljs-number">0</span>
  }
}

<span class="hljs-keyword">const</span> getters = {
  <span class="hljs-comment">// articleList: ({status}) =&gt; status.articleList</span>
  <span class="hljs-comment">// tips: 上面这种方法是错误的。这里的getters传入进来的不是state的根对象，</span>
  <span class="hljs-comment">// 而是当前的state对象，在这里也就相当于是state = state.status</span>
  <span class="hljs-comment">// 所以可以放心的用state</span>
  articleList: <span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> state.articleList
  <span class="hljs-comment">// 设置Getters，在.vue文件里可以使用mapGetters方法获得</span>
}

<span class="hljs-keyword">const</span> mutations = {
  [types.ARTICLE_LIST] (state) {
    state.articleList = !state.articleList
  },
  <span class="hljs-comment">// 设置mutations，只有这个方法可以改变state</span>
  [types.SCROLLDATA] (state, scrollObj) {
    state.scroll = scrollObj
  }
}

<span class="hljs-keyword">const</span> actions = {
  articleListSwitch ({ commit }) {
    commit(types.ARTICLE_LIST)
  },
  <span class="hljs-comment">// 设置actions,可以在这里做一些异步的工作，然后使用commit来调用mutations修改state</span>
  pushScrollData ({ commit }) {
    commit(types.SCROLLDATA, getScrollData(), { <span class="hljs-attr">silent</span>: <span class="hljs-literal">true</span> })
    <span class="hljs-comment">// 因为页面滚动触发频繁，会影响到我们平时的vuex的审查，所以这里选择静默提交</span>
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  state,
  getters,
  actions,
  mutations
}
<span class="hljs-comment">// 而后的.vue文件就可以调用辅助方法达到获取状态或者控制状态的目的了</span>
</code></pre> <p>调试vuex最好使用vuejs的谷歌插件<a href="https://chrome.google.com/webstore/detail/nhdogjmejiglipccpnnnanhbledajbpd">Devtools</a>
或者去github<a href="https://github.com/vuejs/vue-devtools">下载源码自己编译</a>
翻墙要梯子(vpn)，想翻墙没vpn的我这里安利一个vpn，没什么其他，因为我正用的就是这个。
贴一个云梯推荐码<a href="http://referyt.com/?r=f688f08a26bf108d">http://referyt.com/?r=f688f08a26bf108d</a>,通过推荐码注册可以优惠10元，笔者也可以得到10元优惠，在得到优惠的同时也是对我的鼓舞吧😂</p> <h4>渲染链接列表</h4> <p>接下来要做的就是做链接跳转。
切到<code>AppArticleList.vue</code>文件，也就是文章列表页。
大家可以在我的Demo里点击左上角的菜单按钮看到这个列表
!(AppArticleList.vue)[/img/vue/AppArticleList.jpg]</p> <p>里面的内容是这样子的
(因为内容有些复杂，为了看的清晰点这是我提取出来的核心部分)
(源文件可以看<a href="https://github.com/leenty/vue2/blob/master/src/components/templates/AppArticleList.vue">https://github.com/leenty/vue2/blob/master/src/components/templates/AppArticleList.vue</a>)</p> <pre><code class="language-html"><span class="hljs-comment">&lt;!-- 大致的内容就是渲染一个文章列表 --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"pug"</span>&gt;</span>
  .articleList(:class="{'articleList--Active': articleList}").l-page--Full
    ul.articleList__content.u-ul--Reset
      li(
        v-for="(item, index) in list",
        // vuejs的for循环，list指向了data里的list数组(看js部分)
        :style="calcDelay(index)",
        // 绑定返回一个css延时代码(在methods方法下)
        // 主要功能是给菜单提供依次进入的动画效果
        @click="articleListSwitch"
        // 绑定点击事件，控制文章列表的出现和隐藏
      ).articleList__li
        router-link(
        // 通过list里的数据循环生成路由链接
          :to="{name: item.name}",
          // 绑定路由链接，这里用了{name: item.name}是因为相对来说，name比path方便
          // item就是之前for循环里的item
          active-class="articleList__link--Active"
          // 之前的文章的第二篇里对路由时匹配的`linkActiveClass`做了配置，
          // 这里用不到原来配置的class,所以可以用这个方法单独的做处理
          // 把匹配到的链接的class改成了'articleList__link--Active'
        ).articleList__link.u-borderBox.u-link__inherit.l-flexV--c
          .articleList__title
            svg.svg__home.u-va--tb
              use(xlink:href="#svg__articleIcon")
            // 这里用的图标是svg的,关于这种用法，如果有兴趣我可以专门的介绍一下
            | <span>{{</span>item.title<span>}}</span> 
            // 绑定链接的文字
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { mapActions, mapGetters } <span class="hljs-keyword">from</span> <span class="hljs-string">'vuex'</span>
<span class="hljs-comment">// 导入vuex的两个将要用到的辅助方法</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-comment">// export defalut是es6的模块导出方法，这里导出一个默认模块，即是一个vue对象</span>
  data () {
    <span class="hljs-comment">// 这是一种es6对象字面量的缩写，指向一个函数</span>
    <span class="hljs-comment">// 扩展出来就是data: function data () {}</span>
    <span class="hljs-keyword">return</span> {
      <span class="hljs-comment">// 而后在函数里去返回将要用到的数据</span>
      <span class="hljs-comment">// 这么做返回的数据可以使用this访问到</span>
      list: [
        {
          <span class="hljs-attr">name</span>: <span class="hljs-string">'vue2_1'</span>,
          <span class="hljs-attr">title</span>: <span class="hljs-string">'vue2.0一起在懵逼的海洋里越陷越深（一）'</span>
        },
        {
          <span class="hljs-attr">name</span>: <span class="hljs-string">'vue2_2'</span>,
          <span class="hljs-attr">title</span>: <span class="hljs-string">'vue2.0一起在懵逼的海洋里越陷越深（二）'</span>
        },
        {
          <span class="hljs-attr">name</span>: <span class="hljs-string">'vue2_3'</span>,
          <span class="hljs-attr">title</span>: <span class="hljs-string">'vue2.0一起在懵逼的海洋里越陷越深（三）'</span>
        },
        {
          <span class="hljs-attr">name</span>: <span class="hljs-string">'vue2_4'</span>,
          <span class="hljs-attr">title</span>: <span class="hljs-string">'vue2.0一起在懵逼的海洋里越陷越深（四）'</span>
        },
        {
          <span class="hljs-attr">name</span>: <span class="hljs-string">'vue2_5'</span>,
          <span class="hljs-attr">title</span>: <span class="hljs-string">'vue2.0一起在懵逼的海洋里越陷越深（五）'</span>
        }
      ]
    }
  },
  <span class="hljs-attr">computed</span>: mapGetters([<span class="hljs-string">'articleList'</span>]),
  <span class="hljs-comment">// vue的计算方法对象,用法和data里的数据是一样的，</span>
  <span class="hljs-comment">// 这里使用了mapGetters辅助函数，用来获得vuex的Getters里的articleList</span>
  <span class="hljs-comment">// 这个方法会返回一个对象，所以如果没有其他计算方法的话直接赋值给computed就好了</span>
  <span class="hljs-comment">// 有的话可以向下面这样: </span>
  <span class="hljs-comment">// computed: {</span>
  <span class="hljs-comment">//    demo () {</span>
  <span class="hljs-comment">//      return this.list[0].name</span>
  <span class="hljs-comment">//      在这里你可以使用this访问到data里的list</span>
  <span class="hljs-comment">//    },</span>
  <span class="hljs-comment">//    ...mapGetters(['articleList'])</span>
  <span class="hljs-comment">//    ...延展操作符，用于展开mapGetters得到的对象，使得与demo属性平级</span>
  <span class="hljs-comment">// },</span>
  methods: {
    <span class="hljs-comment">// vue的方法对象，你可以在这里写你的事件处理函数或是其他方法</span>
    calcDelay: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">index</span>) </span>{
      <span class="hljs-comment">// 这是分配css动画延迟量的函数</span>
      <span class="hljs-keyword">return</span> {
        <span class="hljs-string">'transitionDelay'</span>: <span class="hljs-string">`.<span class="hljs-subst">${index + <span class="hljs-number">2</span>}</span>s`</span>
      }
    },
    ...mapActions([<span class="hljs-string">'articleListSwitch'</span>])
    <span class="hljs-comment">// 通过延展操作符,展开mapActions得到的actions对象</span>
  }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"stylus"</span>&gt;</span><span class="undefined">
  // css就不多说了
  @import '../../assets/stylus/preinstall'
  .articleList
    background-color c-master
  .articleList__content
    width s-articleList
    margin-top 8vh
    max-height 84vh
    color #fff
  .articleList__li
    transform translateX(-(s-articleList))
    transition transform .3s cb-duang .2s
  .articleList__link
    width 100%
    line-height 1.3em
    padding-left 10px
    min-height 50px
    background-color rgba(255,255,255,.1)
    &amp;:hover
      background-color rgba(255,255,255,.3)
    svg
      transform-origin bottom center
      transform scale(.7)
  .articleList__link--Active
    background-color rgba(255,255,255,.4)
  .articleList--Active .articleList__li
    transform translateX(0)
  .articleList__title
    display block
    width 100%
    font-size 12px
    &amp;:first-line
      font-size 14px
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre> <p>在写的过程中碰到了一个浏览器bug，这里还是说下
bug: 如果父元素进行了transform变换，那么子元素的position fixed将会失去作用,退化成position absolute
解决方案: 之前试过想要使用css的方式去绕过这个问题，但是发现不行，无奈使用了js去计算子元素退化成absolute后的差值，对其进行位移达到视觉的效果。
有兴趣的可以打开<a href="http://vue2.leenty.com/article/vue2_2">http://vue2.leenty.com/article/vue2_2</a>然后审查元素，查看我的导航条也就是<code>.header__content</code>，这个时候你打开侧边栏然后上下滚动就会看到<code>.header__content</code>上js所不全的差值了</p> <h4>装载嵌套路由</h4> <p>打开<code>article.vue</code>文件，文件很简单，内容如下：</p> <pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"pug"</span>&gt;</span>
.article
  h1.l-ta--c 文章页面
  .md-content
    router-view
    // 这个就是二级路由的装载点了
    // 之前的`APP.vue`的`router-view`会装载当前模板，而后的文章都会装载到这个点上。
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
  <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
    data () {
      <span class="hljs-keyword">return</span> {
      }
    }
  }
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"stylus"</span>&gt;</span><span class="undefined">
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre> <h4>关于触发滚动之后的一系列事件</h4> <p>关于触发滚动，考虑到之后可能会有多个页面需要使滚动方面的数据，所以就放在了vuex里作为状态的一部分。
所以滚动的监听就只需要监听一次就好了，多个地方的监听会浪费资源
最终，我把监听放在了<code>App.vue</code>里面,在里面监听'scroll'事件，然后放在vuex上，供有需要的组件去使用</p> <pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"pug"</span>&gt;</span>
  .app.u-clearfix
    app-article-list
    .app__content(
      :class="{'app__content--Active': articleList}",
      // 如果侧拉文章列表打开，那么添加这个class，相应的css效果将被触发
      @scroll="pushScrollData"
      // 绑定scroll事件
    ).l-page--Full
      home-header
      .app__bodyer.l-mH--auto
        router-view
    include ./assets/svg/all
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
  <span class="hljs-keyword">import</span> HomeHeader <span class="hljs-keyword">from</span> <span class="hljs-string">'./components/templates/HomeHeader.vue'</span>
  <span class="hljs-keyword">import</span> AppArticleList <span class="hljs-keyword">from</span> <span class="hljs-string">'./components/templates/AppArticleList.vue'</span>
  <span class="hljs-keyword">import</span> { mapGetters, mapActions } <span class="hljs-keyword">from</span> <span class="hljs-string">'vuex'</span>
  <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
    <span class="hljs-attr">components</span>: {
      HomeHeader,
      AppArticleList
    },
    <span class="hljs-attr">computed</span>: mapGetters([
      <span class="hljs-string">'articleList'</span>
    ]),
    <span class="hljs-attr">methods</span>: {
      ...mapActions([
        <span class="hljs-string">'pushScrollData'</span>,
        <span class="hljs-string">'articleListSwitch'</span>
      ])
    }
  }
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"stylus"</span>&gt;</span><span class="undefined">
  @import './assets/stylus/main'
  .app__menu
    background-color c-master
  .app__content
    overflow auto
    transition transform .5s
    box-shadow 0 0 100px 5px rgba(0,0,0,0.3)
    background-color c-bgc
    transform-origin s-articleList center
  .app__content--Active
    transform scale(.9) translateX(s-articleList)
  .app__bodyer
    max-width max-width
    background-color c-bgc
  @media screen and (max-width: max-width)
    .app__bodyer
      padding 0 10px
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre> <p>ok，这么个流程走下来，算是把<code>vuejs</code>,<code>vue-router</code>和<code>vuex</code>用在了一起</p> <h3>其他</h3> <p><a href="http://vue2.leenty.com">演示地址(http://vue2.leenty.com)</a> <a href="https://github.com/leenty/vue2">源码地址(https://github.com/leenty/vue2)</a> <a href="https://github.com/leenty">github主页</a>,觉得靠谱的话欢迎加星跟随</p></section></div></div></div></div><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="height: 0px; width: 0px; overflow: hidden; float: left;"><defs><g id="svg__home"><path d="M13 18v-1.5c0-1.93-1.57-3.5-3.5-3.5S6 14.57 6 16.5V18H2.783L9.498 7.01 16.216 18H13zm-5 0v-1.5c0-.826.672-1.5 1.5-1.5.826 0 1.5.674 1.5 1.5V18H8zm10.854.48L10.671 5.09l2.181-3.569L11.146.48 9.498 3.173 7.853.478 6.147 1.522l2.182 3.57L.146 18.48A1 1 0 0 0 1 20h17a.999.999 0 0 0 .854-1.52z" fill="currentColor" fill-rule="evenodd"></path></g> <g id="svg__article" fill="currentColor" fill-rule="evenodd"><path d="M16 7.002h-5v2h4v9h-2v2H2v-11h3v-2H1a1 1 0 0 0-1 1v13a1 1 0 0 0 1 1h13c.265 0 .52-.105.707-.293l2-2a.997.997 0 0 0 .293-.707v-11a1 1 0 0 0-1-1"></path> <path d="M13 11.001H4v2h9zM4 17.001h9v-2H4zM7 5.817v3.185a1 1 0 1 0 2 0V5.817A2.988 2.988 0 0 0 11 3a2.998 2.998 0 0 0-3-3 2.997 2.997 0 0 0-2.999 3A2.988 2.988 0 0 0 7 5.817"></path></g> <g id="svg__code" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Line-Icons" transform="translate(-433.000000, -913.000000)" fill="currentColor"><g id="Fill-111-+-Fill-112-+-Fill-113" transform="translate(433.000000, 913.000000)"><path d="M2,18.001 L2,6.001 L19.999,6.001 L19.997,18.001 L2,18.001 Z M5,4.001 L2,4.001 L2,2.001 L5,2.001 L5,4.001 Z M7,2.001 L10,2.001 L10,4.001 L7,4.001 L7,2.001 Z M20,4.001 L12,4.001 L12,2.001 L20,2.001 L20,4.001 Z M20,0.001 L2,0.001 C0.897,0.001 0,0.898 0,2.001 L0,18.001 C0,19.104 0.897,20.001 2,20.001 L20,20.001 C21.103,20.001 22,19.104 22,18.001 L22,2.001 C22,0.898 21.103,0.001 20,0.001 L20,0.001 Z" id="Fill-111"></path> <polygon id="Fill-112" points="12 15.001 17 15.001 17 13.001 12 13.001"></polygon> <polygon id="Fill-113" points="5.293 9.7083 7.586 12.0013 5.293 14.2953 6.707 15.7083 10.414 12.0013 6.707 8.2953"></polygon></g></g></g> <g id="svg__articleIcon" fill="currentColor" fill-rule="evenodd"><path d="M17 17.503c0 .826-.673 1.5-1.5 1.5-.4 0-.777-.157-1.06-.44-.353-.352-.42-.607-.436-1.144-.024-.794-.664-1.416-1.498-1.416-.817 0-1.493.665-1.506 1.482-.022 1.413-.41 1.518-1 1.518-.594 0-.984-.108-1-1.56-.009-.795-.664-1.44-1.5-1.44-.79 0-1.443.593-1.517 1.384-.099 1.056-.611 1.616-1.483 1.616-.827 0-1.5-.674-1.5-1.5v-6.5c0-3.86 3.14-7 7-7s7 3.14 7 7v6.5zm2.414-14.087A2 2 0 1 0 16.586.588a1.99 1.99 0 0 0-.511 1.925L15.039 3.55A8.947 8.947 0 0 0 10 2.003c-1.866 0-3.6.57-5.039 1.546L3.925 2.514A1.992 1.992 0 0 0 3.414.589 2 2 0 1 0 .586 3.417a1.994 1.994 0 0 0 1.925.51l.931.932A8.962 8.962 0 0 0 1 11.002v6.5c0 1.93 1.57 3.5 3.5 3.5 1.251 0 2.267-.573 2.875-1.551.562 1.24 1.662 1.552 2.625 1.552.954 0 2.043-.305 2.61-1.514.116.162.252.325.415.488a3.477 3.477 0 0 0 2.475 1.026c1.93 0 3.5-1.57 3.5-3.5v-6.5a8.962 8.962 0 0 0-2.442-6.144l.931-.931a1.994 1.994 0 0 0 1.925-.511z"></path><path d="M10 12.002c-1.103 0-2-.897-2-2s.897-2 2-2 2 .897 2 2-.897 2-2 2m0-6c-2.206 0-4 1.795-4 4 0 2.207 1.794 4 4 4s4-1.793 4-4c0-2.206-1.794-4-4-4"></path></g> <g id="svg__demo"><path fill="none" d="M0 0h24v24H0z"></path><path fill="currentColor" d="M12 3.002c-4.486 0-8 3.584-8 8.158 0 7.757 7.33 10.656 7.642 10.775a1 1 0 0 0 .716 0C12.67 21.816 20 18.917 20 11.16c0-4.574-3.514-8.158-8-8.158zm.004 16.909C10.665 19.276 6 16.667 6 11.16c0-.183.011-.362.026-.541.073 1.316.699 4.295 4.913 4.295 0 0 .967-4.861-4.833-4.907C6.619 7.124 9.022 5.002 12 5.002s5.382 2.122 5.895 5.005c-5.8.046-4.833 4.907-4.833 4.907 4.213 0 4.84-2.979 4.913-4.294.014.178.025.358.025.54 0 5.548-4.634 8.116-5.996 8.751z"></path></g> <g id="svg__heart--line"><path fill="none" d="M0 0h24v24.001H0z"></path><g fill="currentColor"><path d="M11.994 19.71A37.444 37.444 0 0 1 8.179 16H5.557c2.564 3.22 5.608 5.619 5.828 5.789a.994.994 0 0 0 1.228 0c.196-.152 2.647-2.084 4.996-4.789h-2.714a41.201 41.201 0 0 1-2.901 2.71zM4.103 9a5.67 5.67 0 0 1-.104-1c0-2.43 1.57-4 4-4 1.289 0 2.352.938 2.787 2h2.427c.435-1.062 1.498-2 2.787-2 2.43 0 4 1.57 4 4 0 .653-.133 1.324-.35 2h2.062c.173-.668.288-1.337.288-2 0-3.533-2.467-6-6-6-1.594 0-3.071.837-4 2.08C11.07 2.837 9.593 2 7.999 2c-3.533 0-6 2.467-6 6 0 .332.038.666.083 1h2.021z"></path><path d="M19.696 12l-2.489 1.659-4.125-5.156-4.083 4.083-3-3L3.585 12H.999v2h3.414l1.586-1.585 3 3 3.917-3.918 3.875 4.844L20.302 14h2.697v-2z"></path></g></g> <g id="svg__heart--solid"><path fill="none" d="M0 0h24v24.001H0z"></path><g fill="currentColor"><path d="M2.76 10.002l3.243-3.243L8.754 9.51l4.469-5.587 4.612 6.918 1.26-.84h2.62c.173-.668.288-1.337.288-2 0-3.533-2.467-6-6-6-1.594 0-3.071.837-4 2.08-.929-1.243-2.406-2.08-4-2.08-3.533 0-6 2.467-6 6 0 .663.115 1.332.288 2h.469zM9.251 18.494l-3.249-3.249-.579.579c2.591 3.309 5.742 5.794 5.965 5.967a.994.994 0 0 0 1.228 0 38.463 38.463 0 0 0 3.317-2.984l-3.151-4.727-3.531 4.414z"></path><path d="M19.7 12.002l-2.42 1.613-4.204-6.305-4.157 5.195-2.917-2.917-2.414 2.414H1.002v2h3.415l1.585-1.585 3.083 3.082 3.844-4.804 3.796 5.694 3.58-2.387h2.697v-2z"></path></g></g> <g id="svg__series"><path fill="none" d="M0 0h24v24H0z"></path><path fill="currentColor" d="M20.707 2.292a1 1 0 0 0-.933-.266c-.176.04-4.346 1.021-8.226 2.985a1 1 0 0 0-.548.892v1.672l-.772-.796a1.002 1.002 0 0 0-1.312-.108c-.578.426-1.052.827-1.45 1.225-3.805 3.805-3.689 7.07-2.323 8.962L2 20v3l4.782-4.781a4.82 4.82 0 0 0 2.117.494c1.381 0 3.579-.551 6.206-3.178 3.894-3.894 5.791-11.969 5.87-12.31a1.003 1.003 0 0 0-.268-.933zM13.69 14.12c-2.143 2.143-3.789 2.593-4.792 2.593-.749 0-1.419-.257-1.887-.724-1.109-1.111-1.286-3.526 1.867-6.679a9 9 0 0 1 .539-.492l1.864 1.92A1 1 0 0 0 13 10.042V6.526c2.055-.982 4.171-1.688 5.579-2.104-.739 2.493-2.386 7.195-4.889 9.698z"></path></g> <g id="svg__tags"><path fill="none" d="M0 0h24v24H0z"></path><path fill="currentColor" d="M22 12l-9.899-9.899-1.414 1.413 1.415 1.415v.001L7.151 9.879v.001L5.736 8.466 4.322 9.881l4.243 4.242-5.657 5.656 1.414 1.414 5.657-5.656 4.243 4.242 1.414-1.414-1.414-1.415 4.95-4.95 1.414 1.414L22 12zm-9.191 3.536l-.001.001-4.242-4.243 4.949-4.95 4.242 4.243-4.948 4.949z"></path></g></defs></svg></div><script type="text/javascript" src="/static/js/manifest.6ff5b5a88b8a93d8574c.js"></script><script type="text/javascript" src="/static/js/vendor.a544cda5491080ac6498.js"></script><script type="text/javascript" src="/static/js/app.2758f953a6722dba10a1.js"></script></body></html>
